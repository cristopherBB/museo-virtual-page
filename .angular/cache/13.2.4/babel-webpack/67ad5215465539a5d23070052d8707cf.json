{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/pannellum.service\";\nimport * as i2 from \"src/app/services/api.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"./virtual-view/virtual-view.component\";\nimport * as i5 from \"./canvas/canvas.component\";\nimport * as i6 from \"@angular/material/button\";\nimport * as i7 from \"@angular/material/icon\";\nconst _c0 = [\"virtualView\"];\n\nfunction VirtualMuseumComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 2);\n    i0.ɵɵelement(1, \"app-virtual-view\", 3, 4);\n    i0.ɵɵelementStart(3, \"div\", 5)(4, \"app-canvas\", 6);\n    i0.ɵɵlistener(\"onClick\", function VirtualMuseumComponent_div_0_Template_app_canvas_onClick_4_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.onPinClick($event);\n    });\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"viewId\", ctx_r0.selectedView);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"pins\", ctx_r0.tour.pins)(\"selectedPin\", ctx_r0.selectedPin);\n  }\n}\n\nfunction VirtualMuseumComponent_div_1_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 28);\n    i0.ɵɵlistener(\"click\", function VirtualMuseumComponent_div_1_div_23_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const scene_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.pannellumService.setScene(scene_r6);\n    });\n    i0.ɵɵelementStart(1, \"div\", 29)(2, \"div\", 30);\n    i0.ɵɵelement(3, \"img\", 31);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 32);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const scene_r6 = ctx.$implicit;\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(3);\n    i0.ɵɵattribute(\"src\", ctx_r5.pannellumService.getImageSource(scene_r6), i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r5.pannellumService.getSceneTitle(scene_r6));\n  }\n}\n\nfunction VirtualMuseumComponent_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵelement(1, \"app-virtual-view\", 8);\n    i0.ɵɵelementStart(2, \"div\", 9)(3, \"div\", 10)(4, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function VirtualMuseumComponent_div_1_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.hideMinimap();\n    });\n    i0.ɵɵelementStart(5, \"mat-icon\", 12);\n    i0.ɵɵtext(6, \"location_off\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function VirtualMuseumComponent_div_1_Template_button_click_7_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.showMinimap();\n    });\n    i0.ɵɵelementStart(8, \"mat-icon\", 12);\n    i0.ɵɵtext(9, \"location_on\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"div\", 14)(11, \"app-canvas\", 15);\n    i0.ɵɵlistener(\"onClick\", function VirtualMuseumComponent_div_1_Template_app_canvas_onClick_11_listener($event) {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r12 = i0.ɵɵnextContext();\n      return ctx_r12.onPinClick($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"div\", 16)(13, \"div\", 17)(14, \"button\", 18);\n    i0.ɵɵlistener(\"click\", function VirtualMuseumComponent_div_1_Template_button_click_14_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.closeSceneCarousel();\n    });\n    i0.ɵɵelementStart(15, \"mat-icon\");\n    i0.ɵɵtext(16, \"expand_more\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"button\", 19);\n    i0.ɵɵlistener(\"click\", function VirtualMuseumComponent_div_1_Template_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r14 = i0.ɵɵnextContext();\n      return ctx_r14.openSceneCarousel();\n    });\n    i0.ɵɵelementStart(18, \"mat-icon\");\n    i0.ɵɵtext(19, \"expand_less\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(20, \"div\", 20)(21, \"div\", 21)(22, \"div\", 22);\n    i0.ɵɵtemplate(23, VirtualMuseumComponent_div_1_div_23_Template, 6, 2, \"div\", 23);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(24, \"div\", 24)(25, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function VirtualMuseumComponent_div_1_Template_button_click_25_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.moveCarouselLeft();\n    });\n    i0.ɵɵelementStart(26, \"mat-icon\", 26);\n    i0.ɵɵtext(27, \"arrow_back_ios\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(28, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function VirtualMuseumComponent_div_1_Template_button_click_28_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r16 = i0.ɵɵnextContext();\n      return ctx_r16.moveCarouselRight();\n    });\n    i0.ɵɵelementStart(29, \"mat-icon\", 26);\n    i0.ɵɵtext(30, \"arrow_forward_ios\");\n    i0.ɵɵelementEnd()()()()()()();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"viewId\", ctx_r1.selectedView);\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"pins\", ctx_r1.tour.pins)(\"selectedPin\", ctx_r1.selectedPin);\n    i0.ɵɵadvance(12);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r1.pannellumService.getScenes());\n  }\n} //--------------------------------------------------------\n\n\nexport let VirtualMuseumComponent = /*#__PURE__*/(() => {\n  class VirtualMuseumComponent {\n    constructor( //private pannellumService: PannellumService,\n    pannellumService, //--------------------------------------------------\n    api) {\n      this.pannellumService = pannellumService;\n      this.api = api;\n      this.tour = {\n        pins: [],\n        views: []\n      };\n      this.selectedPin = 0;\n\n      this.onPinClick = viewPosition => {\n        this.selectedPin = viewPosition;\n        this.selectedView = this.tour.views[viewPosition];\n        this.pannellumService.setScene(this.selectedView);\n      }; //--------------------------------------------------------------------\n\n\n      this.userRole = this.api.userRole;\n      /**\r\n       * ---Carrusel de escenas---\r\n      */\n\n      this.index = 0;\n    }\n\n    ngOnInit() {\n      const pins = []; // caminadora\n\n      pins.push({\n        x: 15.5,\n        y: 51.5\n      });\n      pins.push({\n        x: 23.5,\n        y: 51.5\n      });\n      pins.push({\n        x: 33,\n        y: 51.5\n      });\n      pins.push({\n        x: 44.5,\n        y: 51.5\n      });\n      pins.push({\n        x: 56.5,\n        y: 51.5\n      });\n      pins.push({\n        x: 66,\n        y: 51.5\n      });\n      pins.push({\n        x: 75.8,\n        y: 52.3\n      }); // Puesto 2\n\n      pins.push({\n        x: 37.3,\n        y: 32\n      }); // Puesto 4\n\n      pins.push({\n        x: 62,\n        y: 32\n      }); // puesto 7\n\n      pins.push({\n        x: 84,\n        y: 60\n      });\n      this.tour.pins = pins;\n      const views = [];\n      views.push('pasillo-1');\n      views.push('pasillo-2');\n      views.push('pasillo-3');\n      views.push('pasillo-4');\n      views.push('pasillo-5');\n      views.push('pasillo-6');\n      views.push('pasillo-7');\n      views.push('sala-2');\n      views.push('tienda-chocolate');\n      views.push('sala-fotografia');\n      this.tour.views = views;\n      this.selectedView = this.tour.views[0];\n    } //--------------------------------------------------------------------\n\n    /**\r\n      * hideMinimap\r\n      * Esconde el minimapa del recorrido virtual\r\n      */\n\n\n    hideMinimap() {\n      document.getElementById(\"minimap\").style.paddingLeft = \"1000px\";\n      document.getElementById(\"button-show-minimap\").style.display = \"block\";\n      document.getElementById(\"button-hide-minimap\").style.display = \"none\";\n    }\n    /**\r\n      * showMinimap\r\n      * Muestra el minimapa del recorrido virtual\r\n      */\n\n\n    showMinimap() {\n      document.getElementById(\"minimap\").style.paddingLeft = \"0px\";\n      document.getElementById(\"button-show-minimap\").style.display = \"none\";\n      document.getElementById(\"button-hide-minimap\").style.display = \"block\";\n    }\n    /**\r\n      * closeSceneCarousel()\r\n      * Esconde el carrusel de escenas del recorrido\r\n      */\n\n\n    closeSceneCarousel() {\n      document.getElementById(\"carousel\").style.height = \"0vh\";\n      document.getElementById(\"open-carousel\").style.display = \"block\";\n      document.getElementById(\"close-carousel\").style.display = \"none\";\n    }\n    /**\r\n      * openSceneCarousel()\r\n      * Muestra el carrusel de escenas del recorrido\r\n      */\n\n\n    openSceneCarousel() {\n      document.getElementById(\"carousel\").style.height = \"20vh\";\n      document.getElementById(\"open-carousel\").style.display = \"none\";\n      document.getElementById(\"close-carousel\").style.display = \"block\";\n    }\n    /**\r\n      * moveCarouselRight\r\n      * Mueve el carrusel hacia la derecha\r\n      */\n\n\n    moveCarouselRight() {\n      this.index++;\n      const carouselWidth = document.getElementById(\"carousel-container\").offsetWidth;\n      const cardsPerCarousel = 5;\n      const cardWidth = carouselWidth / cardsPerCarousel;\n      let translation = this.index * cardWidth;\n      document.getElementById(\"prev\").style.display = \"block\"; // Muestra el botón izquierdo\n\n      document.getElementById(\"track\").style.transform = \"translateX(-\" + translation + \"px)\"; // Mueve el carrusel\n      // Cuando el carrusel llega al final se quita el botón de la derecha\n\n      if (document.getElementById(\"track\").offsetWidth - this.index * cardWidth <= cardWidth * cardsPerCarousel) {\n        document.getElementById(\"next\").style.display = \"none\";\n      }\n    }\n    /**\r\n      * moveCarouselLeft\r\n      * Mueve el carrusel hacia la izquierda\r\n      */\n\n\n    moveCarouselLeft() {\n      this.index--;\n      const carouselWidth = document.getElementById(\"carousel-container\").offsetWidth;\n      const cardsPerCarousel = 5;\n      const cardWidth = carouselWidth / cardsPerCarousel;\n      let translation = this.index * cardWidth;\n      document.getElementById(\"next\").style.display = \"block\"; // Muestra el botón derecho\n\n      document.getElementById(\"track\").style.transform = \"translateX(-\" + translation + \"px)\"; // Mueve el carrusel\n      // Cuando el carrusel llega al principio se quita el botón de la izquierda\n\n      if (this.index == 0) {\n        document.getElementById(\"prev\").style.display = \"none\";\n      }\n    }\n\n  }\n\n  VirtualMuseumComponent.ɵfac = function VirtualMuseumComponent_Factory(t) {\n    return new (t || VirtualMuseumComponent)(i0.ɵɵdirectiveInject(i1.PannellumService), i0.ɵɵdirectiveInject(i2.ApiService));\n  };\n\n  VirtualMuseumComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: VirtualMuseumComponent,\n    selectors: [[\"app-virtual-museum\"]],\n    viewQuery: function VirtualMuseumComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.virtualView = _t.first);\n      }\n    },\n    decls: 2,\n    vars: 2,\n    consts: [[\"class\", \"container\", 4, \"ngIf\"], [\"style\", \"width: 100%; height: 100%; position: relative; overflow: hidden\", 4, \"ngIf\"], [1, \"container\"], [\"id\", \"virtualView\", 3, \"viewId\"], [\"virtualView\", \"\"], [1, \"croquis-content\"], [1, \"croquis\", 3, \"pins\", \"selectedPin\", \"onClick\"], [2, \"width\", \"100%\", \"height\", \"100%\", \"position\", \"relative\", \"overflow\", \"hidden\"], [3, \"viewId\"], [1, \"div-minimapa\"], [1, \"div-buttons-minimapa\"], [\"mat-raised-button\", \"\", \"id\", \"button-hide-minimap\", 1, \"buttons-minimapa\", 3, \"click\"], [2, \"vertical-align\", \"sub\", \"transform\", \"translateX(-50%) scale(0.8)\"], [\"mat-raised-button\", \"\", \"id\", \"button-show-minimap\", 1, \"buttons-minimapa\", 2, \"display\", \"none\", 3, \"click\"], [\"id\", \"minimap\", 1, \"croquis-content\", 2, \"margin-top\", \"20px\", \"transition\", \"0.4s all ease-in-out\"], [\"id\", \"canvas\", 1, \"croquis\", 3, \"pins\", \"selectedPin\", \"onClick\"], [\"id\", \"div-carousel\", 1, \"div-carousel\"], [1, \"div-carousel-button\"], [\"mat-raised-button\", \"\", \"id\", \"close-carousel\", 1, \"display-carousel-button\", 3, \"click\"], [\"mat-raised-button\", \"\", \"id\", \"open-carousel\", 1, \"display-carousel-button\", 2, \"display\", \"none\", 3, \"click\"], [\"id\", \"carousel\", 1, \"carousel\"], [\"id\", \"carousel-container\", 1, \"carousel-container\"], [\"id\", \"track\", 1, \"track\"], [\"class\", \"card-container\", 3, \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"carousel-buttons\"], [\"id\", \"prev\", 1, \"prev\", 3, \"click\"], [1, \"icon-move-carousel\"], [\"id\", \"next\", 1, \"next\", 3, \"click\"], [1, \"card-container\", 3, \"click\"], [1, \"card\"], [1, \"img\"], [\"alt\", \"\", 1, \"image\"], [1, \"info\"]],\n    template: function VirtualMuseumComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, VirtualMuseumComponent_div_0_Template, 5, 3, \"div\", 0);\n        i0.ɵɵtemplate(1, VirtualMuseumComponent_div_1_Template, 31, 4, \"div\", 1);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.userRole == \"admin\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.userRole == \"visitante\");\n      }\n    },\n    directives: [i3.NgIf, i4.VirtualViewComponent, i5.CanvasComponent, i6.MatButton, i7.MatIcon, i3.NgForOf],\n    styles: [\".container[_ngcontent-%COMP%]{display:flex;padding:16px;justify-content:space-evenly}.croquis-content[_ngcontent-%COMP%]{display:flex;align-items:flex-end}#virtualView[_ngcontent-%COMP%]{width:1200px}.div-minimapa[_ngcontent-%COMP%]{position:absolute;top:0;right:0;width:350px;margin-top:10px}.div-buttons-minimapa[_ngcontent-%COMP%]{display:flex;justify-content:center;position:absolute;right:0;margin-right:25px}.buttons-minimapa[_ngcontent-%COMP%]{min-width:unset!important;height:30px;width:30px}.div-carousel[_ngcontent-%COMP%]{position:absolute;bottom:0;width:100%;overflow:hidden}.div-carousel-button[_ngcontent-%COMP%]{display:flex;justify-content:center}.display-carousel-button[_ngcontent-%COMP%]{border-radius:100% 100% 0 0;background-color:#000;color:#fff}.carousel[_ngcontent-%COMP%]{width:100%;height:20vh;background-color:#00000080;transition:.3s all ease-in-out}.carousel-container[_ngcontent-%COMP%]{width:100vw;margin:0;position:relative;overflow:hidden;padding:20px}.carousel-container[_ngcontent-%COMP%]   .carousel-inner[_ngcontent-%COMP%]{overflow:hidden}.carousel-container[_ngcontent-%COMP%]   .track[_ngcontent-%COMP%]{display:inline-flex;transition:transform .5s}.carousel-container[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]{width:210px;flex-shrink:0;height:15vh;box-sizing:border-box}.carousel-container[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{width:100%;height:100%;width:190px;box-sizing:border-box;border-radius:10px;display:flex;flex-direction:column;cursor:pointer;opacity:.8}.carousel-container[_ngcontent-%COMP%]   .card-container[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{opacity:1;box-shadow:0 8px 8px 8px #0003,0 8px 8px #00000024,0 8px 8px #0000001f!important}.carousel-buttons[_ngcontent-%COMP%]{text-align:center}.carousel-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:35px;height:35px;border-radius:50%;border:1px solid #000000;background-color:#000;color:#fff;position:absolute;top:50%;transform:translateY(-50%);cursor:pointer}.carousel-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2e2b2b;border:1px solid #2E2B2B}.carousel-buttons[_ngcontent-%COMP%]   .prev[_ngcontent-%COMP%]{display:none}.carousel-buttons[_ngcontent-%COMP%]   .next[_ngcontent-%COMP%]{right:0px;margin-right:60px}.icon-move-carousel[_ngcontent-%COMP%]{transform:scale(.5)!important}.card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center}.card[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]{font-size:30px}.card[_ngcontent-%COMP%]   .img[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{-o-object-fit:cover;object-fit:cover;width:190px;height:10vh;box-sizing:border-box}.card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-basis:40px;background:rgba(0,0,0,.7);color:#fff;flex-grow:0;box-sizing:border-box}\"]\n  });\n  return VirtualMuseumComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}